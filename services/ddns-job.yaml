apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: ddns-job
  namespace: default
spec:
  encryptedData:
    AWS_ACCESS_KEY_ID: AgBATLHrcS+XaMhVfyJXBT6eMUcKIo4vgWzFtDO4CDGzcAQEuI3Q8E3GGYJCcPBwl8YlKUT4ogDVNVqweHyARfJ0vyE8aNV7J+1E6Ltqw1KO2hTvnYgPHDHYLkFDDkCuxqHYbxrhEwy5nVSbSeobzfJos7z4+bKbI3kXDqrPboOwl6+rGdWSBeIH2Bdq8aUmjGa/Ip/8UGbzwQqza0ZhOMwOclYpRC6fa5RmC2fvZ73eI13xDkg8dSTsmFWSC8q8DUEOw1RsyLCRd/7k3/Ckm82XNVi1HBAtHwhKInqGKSCPoMD1PpXJ+R9HECsQ9z/vUHcj7KvnjC/24TRkgbvU9qRBQ2K5kgKQuHsrmk4T8Nc61+5ba7el+HsNeu8f088Qg6srhGqX1cfT6Q89dgAryVvBl/3555wiybppWQ+rjWz6k8hrkArBxywE7SoEfBss4xepIHRD4kozdGkmfjkx7zxFYSNgD0cazN0E+cDWCZD+Ug2bY9/ytpX9rcXIbv1d1X5JDbu0fdMLdRLhSaFXMR8lnNFcMfKrNndM8lJKq6imS9P0Tu5udK88KgK6ZRBvZvDsWPTNKspqa+qEhm53lE/j/qsOW9qmsI/qv91+0lFysYQocEcgyHhHSWKVngePFYgy7SKmdZJuXeKSvQf0SRkWVBSCOQYfvQlIHys/wRrq7c1l9LkNKdX3Jg3pTbN5ADCLoI4pPqc0dfioGF2+cxM=
    AWS_SECRET_ACCESS_KEY: AgA7PClGkq2Xn8EeX8L3HrMD8BEBlLVpSAzU8tQ4o3kP+OjXXpXHcE0LIPFIwpggv1FvTvrWY9FyLwn6vyhfgXd261GwfxcPKZXSasHpfTzM/w82O3PT5dWmHqJCa2OUdLTv2q3ZRKp5teXPUqKS4khUnl7DMMWc5qBwGVZTDEdGtdv8zCrX901uzp/Lf05fToRgleYkQYFxKBRc2chWi+mOyySXMxjETIzyJELrz7DgGkJ9VN6mEw39qg04nYfQz9vuohIYVXtK3J8s0JxMcatfgRY42/igeRsgAF7DtIRAguiQqaqR+NG4FcBN3pA45dkudcCDKnYbeLsW/a/F+7l0mytW0pfc+x2uLieUSxcCC4+wLCvlmYiVKuzBnAak+98vkGvq5bXf12Y8oVR4Ah6uBMAgDMN464C3b3GShxg5slYIjUxcEB02TPhkIc40/ZvOi+WhejAhKM9LN8gIz8R294/d6jcSFV0vIZChIG2nbfnRIhcZJxrugdNBwEC8RW5KvQKEm3JZpayQf3ZjvNlrFqsC9W0aClpF+duOymhalhcLSiW3wfM9tZJyAutJ3MSyUm9Gpt6HMBCpVu1Ci/a3xF39fadbERhF8YOjCagUMTt1+0XOE0fTaoi08fv/sY3G+Fd6KVYphaN5itpR/0tyck+Wp1D8mdfWZ5pm/7Zxz+cddMTnfbcNSNhcowgcvxEBwb+wfuzSG8laLDhC8WLLjqegliXDstGPkoS9hAI=
  template:
    metadata:
      creationTimestamp: null
      name: ddns-job
      namespace: default
---
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: ddns-job
spec:
  schedule: "*/15 * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: ddns-job
            image: ghcr.io/jamesgawn/ddns-job:1.0.0 # {"$imagepolicy": "default:ddns-job"}
            env:
            - name: AWS_DEFAULT_REGION
              value: eu-west-2
            envFrom:
            - secretRef:
                name: ddns-job
            args:
            - "-z=gawn.dev."
            - "-d=cluster.gawn.dev"
          restartPolicy: OnFailure
---
apiVersion: image.toolkit.fluxcd.io/v1alpha1
kind: ImageRepository
metadata:
  name: ddns-job
spec:
  image: ghcr.io/jamesgawn/ddns-job
  interval: 5m0s
---
apiVersion: image.toolkit.fluxcd.io/v1alpha1
kind: ImagePolicy
metadata:
  name: ddns-job
spec:
  imageRepositoryRef:
    name: ddns-job
  policy:
    semver:
      range: x.x.x
