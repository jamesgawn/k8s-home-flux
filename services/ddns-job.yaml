apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  creationTimestamp: null
  name: ddns-job
  namespace: default
spec:
  encryptedData:
    AWS_ACCESS_KEY_ID: AgAvcMK6/aL1zmDjxgZ6F8KUoUpfi5aYlcRP5lRxWt0eVeUnSUS+Z0nHiXOKApP/3z2PM96kceEsmG3yPQlcThJWirwgBXkxWbSLExDVD2f8e6VYCyzM4l+82hpSHpQq1RllXy+0DJyFtUsLNjdmC+wVh9envE22mN6YJkOLgaE7Ov1e7NZgj/q7B78KMYAyyvM4lcqNyi2AGOgBS7Hl2WRUUywl+HK0AkEFzEPo49RfOR5wNeqAwt0jm91fkShfAEMVmPJk6SnDb9QGCz1juk2JhQeJCl5EqAFitTSlpEHeUu1K74FyHYcEIpkJN5ioKReKnivAylqQ8vqs1vay33SimEYCzkJIo+BWkC/feg7vP6AtMdgMQsHcdk//B2eHoPJw07fTguiIkKomaTl4FJTWODzuiWutG0/1O77/ahdYUdYz+o+ajrgAlQK4ujqeeHpIpDU7FoEpap/DYkoAAI3TCBoMpnTgwJwdOGJBvylM4e0Mi5HaEJj8E7zthboelGu45dFgUsUpbgBzcJ0PJjW4ls4EkiDScxo3uRwqDHoeEzyKYM5t8GthmWaILG4FB1KnnM/t7QfSY4K+U/5KYdbreAhajqRSDwmbXcAr9Rz4GvbXfbglf7g6lXGyEv7bIp0R62uAK37M8K60TLoOD8W8Z0Ec9egdxlq9FvUKHMhrXc/XFmAXtKGx3j/Lxdij9C/YZ2LIpCyfD506GKJ8MTImpKSyidY=
    AWS_SECRET_ACCESS_KEY: AgCO37pvL9Fm0GRYoBl1vx5e+ylajKn49mcTY+O9vbqFvSWRjyA1joJGj6Rtp62n5CnumaVpnAh0sCJixiWI0+tsOqo6joIu47+brfy0A+XXK6hfJfUx4Nf+5XZB1n4/GhcUEPRpqoh2EI/CexWTXnNIcxsRWFFbqMdbp/0/I/K2vmPv/+9HQ0w43ruZNqVYofvXLS4uSY1N9i4tU6r+qVP7AW5Q2NF+Ox5g2/egRNuXIeVk4WhO6zgPkFMn5FFI7BbI9/y6OmlqtI/O8pHBD8IcY9dnWQBZ+Suzn+S+r5SXiHtO52uyHIeaIIqqdYEOUqpIq0sAySC/NGu+B/nWDdy80+QStexf5EoJBvUtkWXAKfkwuPEG9Wk6Ql66wtc092Jf2QWkE4IhsZWLHxZU7qavcSJ1J/9jwkIJj/cVtHFmp7mkFayzP9ppkyw7UthgBNWHJZcy2nj/9Pn5qll36MtPz/QJ2LJ2+F0TAyzpyOog0sfcOYfDXSsy0HaB/7VLRgmZ0+QAN+SkeXiSjCqwvULN9K5c125PWYY2KTd8ClzB2uc51WxzdsO5vpfFijbA6lyBBi8/6BhOz1uwluu/1gRIIy9XgrnIUgyZZXpITQfXGCFUFLDxNf3Ej7bu1SMe7zqKk6SmkIw6ARgH2MGI+lmn9on8tibYElY3CRHnILHSXKJOIv5E+iLg3Y3hpUZRGVeSR3O2UQC3evbz1934SuKS15Pur54YRnOncyVOLAW6puj1kogTWRL0vg==
  template:
    metadata:
      creationTimestamp: null
      name: ddns-job
      namespace: default
---
apiVersion: batch/v1beta1
kind: CronJob
metadata:
  name: ddns-job
spec:
  schedule: "*/15 * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: ddns-job
            image: ghcr.io/jamesgawn/ddns-job:1.0.0 # {"$imagepolicy": "default:ddns-job"}
            env:
            - name: AWS_DEFAULT_REGION
              value: eu-west-2
            envFrom:
            - secretRef:
                name: ddns-job
            args:
            - "-z=gawn.dev."
            - "-d=cluster.gawn.dev"
          restartPolicy: OnFailure
---
apiVersion: image.toolkit.fluxcd.io/v1alpha1
kind: ImageRepository
metadata:
  name: ddns-job
spec:
  image: ghcr.io/jamesgawn/ddns-job
  interval: 5m0s
---
apiVersion: image.toolkit.fluxcd.io/v1alpha1
kind: ImagePolicy
metadata:
  name: ddns-job
spec:
  imageRepositoryRef:
    name: ddns-job
  policy:
    semver:
      range: x.x.x
